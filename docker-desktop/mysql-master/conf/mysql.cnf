[mysqld]
# *************** 基础配置 *************** #
# 服务器唯一ID，主从节点必须不同
server-id = 1
# MySQL服务端口
port = 3306
# 数据存储目录
datadir = /var/lib/mysql
# 套接字文件路径
socket = /var/run/mysqld/mysqld.sock
# PID文件路径
pid-file = /var/run/mysqld/mysqld.pid

# *************** 字符集配置 *************** #
# 服务器默认字符集
character-set-server = utf8mb4
# 服务器默认排序规则
collation-server = utf8mb4_unicode_ci
# 连接时初始化设置
init_connect = 'SET NAMES utf8mb4'

# *************** 二进制日志配置(主从复制必需) *************** #
# 二进制日志文件名前缀
log_bin = mysql-bin
# 二进制日志格式：STATEMENT, ROW, MIXED
binlog_format = ROW
# 二进制日志过期天数
expire_logs_days = 7
# 单个二进制日志文件最大大小
max_binlog_size = 100M
# 二进制日志缓存大小
binlog_cache_size = 1M
# 每次事务提交时MySQL都会将二进制日志同步到磁盘
sync_binlog = 1

# *************** 复制配置 *************** #
# 启用GTID模式
gtid_mode = ON
# 强制GTID一致性
enforce_gtid_consistency = ON
# 从服务器将更新写入二进制日志
log_slave_updates = ON

# *************** 性能优化 *************** #
# InnoDB缓冲池大小
innodb_buffer_pool_size = 1G
# InnoDB日志文件大小
innodb_log_file_size = 256M
# InnoDB日志缓冲区大小
innodb_log_buffer_size = 16M
# 事务提交时日志写入磁盘方式：1-每次提交都写入磁盘，2-每秒写入磁盘
innodb_flush_log_at_trx_commit = 1
# 每个表使用独立的表空间文件
innodb_file_per_table = ON
# InnoDB刷新方法
innodb_flush_method = O_DIRECT

# *************** 连接配置 *************** #
# 最大连接数
max_connections = 500
# 线程缓存大小
thread_cache_size = 16
# 表打开缓存数量
table_open_cache = 2000

# *************** 其他优化 *************** #
# 跳过域名解析，直接使用IP
skip_name_resolve = 1
# 是否只读模式，主节点设为0（可写）
read_only = 0
# 默认身份验证插件
default_authentication_plugin = mysql_native_password

# *************** 错误日志 *************** #
# 错误日志文件路径
log_error = /var/log/mysql/mysql-error.log

# *************** 慢查询日志 *************** #
# 是否启用慢查询日志
slow_query_log = 1
# 慢查询日志文件路径
slow_query_log_file = /var/log/mysql/mysql-slow.log
# 慢查询阈值（秒）
long_query_time = 2
# 是否记录没有使用索引的查询
log_queries_not_using_indexes = 0

# *************** 安全配置 *************** #
# 限制LOAD DATA等语句能操作的文件目录
secure_file_priv = /var/lib/mysql-files

[mysql]
# MySQL客户端默认字符集
default-character-set = utf8mb4

[client]
# 客户端默认字符集
default-character-set = utf8mb4