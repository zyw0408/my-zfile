# 云盘系统开发文档 - 项目概述

## 1. 项目背景

基于对 ZFile 开源网盘系统的深度分析，我们将开发一个简化版但核心功能完整的在线云盘系统。该系统采用前后端分离架构，提供现代化的文件管理体验。

## 2. 技术选型

### 2.1 后端技术栈
- **开发语言**: Java 17+
- **开发框架**: Spring Boot 3.x
- **ORM框架**: MyBatis
- **数据库**: MySQL 8.0+
- **缓存**: Redis 7.x
- **安全框架**: Spring Security + JWT
- **文件存储**: 本地存储、阿里云OSS、腾讯云COS（可扩展）
- **API文档**: Knife4j (Swagger 3.x)
- **构建工具**: Maven 3.8+

### 2.2 前端技术栈
- **开发框架**: Vue 3 + TypeScript
- **UI框架**: Element Plus
- **状态管理**: Pinia
- **路由管理**: Vue Router 4
- **HTTP客户端**: Axios
- **构建工具**: Vite 4.x
- **包管理器**: pnpm

## 3. 核心功能模块

### 3.1 用户端功能
1. **文件浏览**
   - 文件列表展示（列表/网格/图库模式）
   - 文件夹导航
   - 面包屑路径
   - 文件搜索
   - 文件排序（名称、大小、时间）

2. **文件预览**
   - 图片预览（支持图片画廊）
   - 视频在线播放（mp4、flv、m3u8）
   - 音频在线播放
   - 文本文件预览（txt、md、json、xml等）
   - PDF在线预览
   - Office文档预览（docx、xlsx、pptx）

3. **文件操作**
   - 文件上传（支持拖拽、粘贴、断点续传）
   - 文件下载（支持批量下载）
   - 文件重命名
   - 文件删除（支持批量删除）
   - 文件移动/复制
   - 新建文件夹
   - 文件分享（生成直链和二维码）

4. **用户功能**
   - 用户注册/登录
   - 个人信息管理
   - 存储空间查看
   - 操作历史记录

### 3.2 管理端功能
1. **用户管理**
   - 用户列表
   - 用户增删改查
   - 用户状态管理（启用/禁用）
   - 用户存储配额设置
   - 用户权限管理

2. **存储源管理**
   - 存储源配置（本地、OSS等）
   - 存储源状态监控
   - 存储源切换

3. **文件管理**
   - 全局文件查看
   - 文件审核
   - 文件回收站管理
   - 文件统计分析

4. **系统设置**
   - 网站基本信息设置
   - 显示设置（自定义CSS/JS）
   - 安全设置
   - 邮件配置
   - 日志管理

## 4. 系统特色

### 4.1 核心特色
- **响应式设计**: 完美适配PC、平板、手机
- **高性能**: 支持大文件上传、断点续传、秒传
- **易用性**: 类似本地文件管理器的操作体验
- **可扩展**: 模块化设计，易于扩展新的存储源
- **安全性**: JWT认证、权限控制、文件加密

### 4.2 创新功能
- 文件夹加密保护
- Markdown README 渲染
- 文件版本管理
- 智能文件搜索
- 操作日志审计

## 5. 系统架构

```
┌─────────────────────────────────────────────────┐
│                   用户层                          │
│  PC端浏览器 / 移动端浏览器 / 管理后台             │
└─────────────────────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────┐
│                   接口层                          │
│  用户API / 文件API / 管理API / 认证API           │
└─────────────────────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────┐
│                   业务层                          │
│  用户服务 / 文件服务 / 存储服务 / 权限服务       │
└─────────────────────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────┐
│                   数据层                          │
│  MySQL / Redis / 文件存储                        │
└─────────────────────────────────────────────────┘
```

## 6. 项目目录结构

### 6.1 后端目录
```
cloud-disk-backend/
├── src/main/java/com/cloudisk/
│   ├── common/              # 公共模块
│   │   ├── config/          # 配置类
│   │   ├── constant/        # 常量定义
│   │   ├── exception/       # 异常处理
│   │   ├── utils/           # 工具类
│   │   └── aspect/          # 切面
│   ├── module/
│   │   ├── auth/            # 认证授权模块
│   │   ├── user/            # 用户模块
│   │   ├── file/            # 文件模块
│   │   ├── storage/         # 存储模块
│   │   ├── share/           # 分享模块
│   │   └── admin/           # 管理模块
│   └── CloudDiskApplication.java
├── src/main/resources/
│   ├── application.yml
│   ├── application-dev.yml
│   └── mapper/              # MyBatis映射文件
└── pom.xml
```

### 6.2 前端目录
```
cloud-disk-frontend/
├── src/
│   ├── api/                 # API接口
│   ├── assets/              # 静态资源
│   ├── components/          # 公共组件
│   ├── views/               # 页面视图
│   │   ├── user/            # 用户端页面
│   │   └── admin/           # 管理端页面
│   ├── router/              # 路由配置
│   ├── stores/              # 状态管理
│   ├── utils/               # 工具函数
│   ├── types/               # TypeScript类型
│   ├── App.vue
│   └── main.ts
├── public/
├── index.html
├── vite.config.ts
└── package.json
```

## 7. 开发计划

### Phase 1: 基础架构搭建（Week 1-2）
- 项目初始化
- 数据库设计
- 基础框架搭建
- 用户认证系统

### Phase 2: 核心功能开发（Week 3-6）
- 文件上传下载
- 文件预览
- 文件管理
- 存储源对接

### Phase 3: 高级功能开发（Week 7-8）
- 文件分享
- 搜索功能
- 权限控制
- 管理后台

### Phase 4: 测试优化（Week 9-10）
- 功能测试
- 性能优化
- 安全加固
- 文档完善

## 8. 非功能性需求

### 8.1 性能要求
- 接口响应时间: < 200ms（90%）
- 支持并发用户: 1000+
- 文件上传速度: 充分利用带宽
- 数据库查询优化: 使用索引，控制在50ms内

### 8.2 安全要求
- 用户密码加密存储（BCrypt）
- JWT Token有效期管理
- 文件访问权限控制
- SQL注入防护
- XSS攻击防护
- CSRF攻击防护

### 8.3 可用性要求
- 系统可用性: 99.9%
- 数据备份策略
- 日志记录完整
- 异常监控告警

## 9. 部署方案

### 9.1 开发环境
- Docker Compose 一键部署
- 包含MySQL、Redis、后端、前端

### 9.2 生产环境
- Nginx反向代理
- 后端服务集群
- MySQL主从复制
- Redis哨兵模式
- 文件存储CDN加速

## 10. 参考资料

- ZFile官方文档: https://docs.zfile.vip/
- ZFile演示站: https://demo.zfile.vip/local-demo
- Spring Boot文档: https://spring.io/projects/spring-boot
- Vue 3文档: https://vuejs.org/

